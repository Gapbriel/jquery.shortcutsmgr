/*! jquery.shortcutsmgr 2013-12-25 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery,Class)}(function(a,b){var c=b.extend({regions:null,keys:[],key:null,selectionClass:null,init:function(a){this.regions={},this.selectionClass=a&&a.selectionClass||"highlighted-region"},addRegion:function(b){var c=b;if(!(b instanceof d)){var e=a.extend(b,{shortcutsMgr:this,selectionClass:b.selectionClass||this.selectionClass});c=new d(e)}return this.regions[c.name]=this.regions[c.name]||{},this.regions[c.name]=c,this.keys.push(c.name),c},removeRegion:function(a){delete this.regions[a];var b=this.keys.indexOf(a);this.keys.splice(b,1)},startRegion:function(a,b,c){var d;if(this.regions[a])if(this.regions[this.currentKey]&&this.regions[this.currentKey].unPlug(),d=this.regions[a].plug(c))this.currentKey=a;else{var e=b?this.getNextRegion(a):this.getPrevRegion(a);this.startRegion(e,b)}},startNextRegion:function(){var a=this.getNextRegion();this.startRegion(a,!0)},startPrevRegion:function(){var a=this.getPrevRegion();this.startRegion(a,!1)},stopRegion:function(a){this.regions[a]&&this.regions[a].unPlug()},getNextRegion:function(a){for(var b=a?a:this.currentKey,c=0;c<=this.keys.length-1;c++)if(this.keys[c]===b)return void 0===this.keys[c+1]?this.keys[0]:this.keys[c+1]},getPrevRegion:function(a){for(var b=a?a:this.currentKey,c=0;c<=this.keys.length-1;c++)if(this.keys[c]===b)return this.keys[c-1]?this.keys[c-1]:this.keys[this.keys.length-1]},getNext:function(a){for(var b=0;b<=this.keys.length-1;b++)if(this.keys[b]===a)return void 0===this.keys[++b]?this.keys[0]:this.keys[b]},getActiveRegion:function(){return this.regions[this.currentKey]}}),d=b.extend({defaults:{name:null,events:[],regionEl:null,activated:!1,enableInInput:!1,$inputs:null,shortcutsMgr:null,selectionClass:null,autoActivateEvent:null},init:function(b){a.extend(this,this.defaults,b),this.onEnterRegion=b.onEnterRegion&&a.isFunction(b.onEnterRegion)?b.onEnterRegion:this.onEnterRegion,this.onExitRegion=b.onExitRegion&&a.isFunction(b.onExitRegion)?b.onExitRegion:this.onExitRegion,this.enableInInput&&(this.$inputs=a(this.regionEl+" input")),this.bindActivateRegion()},addEvent:function(a){this.events.push(a)},addEvents:function(a){var b;for(b in a)this.addEvent(b)},plug:function(b){if(!a(this.regionEl).length)return!1;this.activated=!0;var c,d;for(c in this.events)a(document).bind(this.events[c].types,this.events[c].keys,this.events[c].handler),this.enableInInput&&(d=this.events[c].keys,_.indexOf(d,"space")<0&&_.indexOf(d,"return")<0&&this.$inputs.bind(this.events[c].types,this.events[c].keys,this.events[c].handler));return this.onEnterRegion(b),a(this.regionEl).addClass(this.selectionClass),!0},unPlug:function(){this.activated=!1;var b;for(b in this.events)this.events[b].types&&(a(document).unbind(this.events[b].types,this.events[b].handler),this.enableInInput&&this.$inputs.unbind(this.events[b].types,this.events[b].handler));a(this.regionEl).removeClass(this.selectionClass),this.onExitRegion()},bindActivateRegion:function(){if(this.regionEl&&this.autoActivateEvent){var b=this;a(document).ready(function(){a(b.regionEl).on(b.autoActivateEvent,b.activateRegion.bind(b))})}},activateRegion:function(a){this.activated||this.shortcutsMgr.startRegion(this.name,!1,a.target)},onEnterRegion:function(){},onExitRegion:function(){}});a.ShortcutsMgr=c});